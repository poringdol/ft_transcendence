{"ast":null,"code":"var _require = require(\"underscore\"),\n    template = _require.template;\n\n$(function () {\n  window.App = {\n    Models: {},\n    Views: {},\n    Collections: {},\n    Router: {}\n  }; // -----------------------------------------\n  //  USER              MODEL\n  // -----------------------------------------\n\n  App.Models.User = Backbone.Model.extend({\n    initialize: function initialize(data) {\n      this.id = data.user.id;\n      this.nickname = data.user.nickname;\n      this.avatar = data.user.avatar;\n      this.email = data.user.email;\n      this.guild_id = data.user.guild_id;\n      this.loses = data.user.loses;\n      this.wins = data.user.wins;\n      this.score = data.user.score;\n      this.is_banned = data.user.is_banned;\n      this.is_admin = data.user.is_admin;\n      this.is_moderator = data.user.is_moderator;\n    }\n  }); // ---------------------------------------------------------------------------------------------------------------------------\n  //                                                   F R I E N D S\n  // ---------------------------------------------------------------------------------------------------------------------------\n  // -----------------------------------------\n  //  FRIENDS       MODEL and COLLECTION\n  // -----------------------------------------\n\n  App.Models.UserFriend = Backbone.Model.extend({\n    urlRoot: \"/friends/get_friends/\",\n    initialize: function initialize(data) {\n      this.urlRoot += usr_id;\n      if (typeof data.friend === \"undefined\") return;\n      this.id = data.friend.friend_id;\n      this.nickname = data.friend.nickname;\n      this.avatar = data.friend.avatar;\n    }\n  });\n  App.Collections.UserFriends = Backbone.Collection.extend({\n    model: App.Models.UserFriend,\n    url: \"/friends/get_friends/\",\n    initialize: function initialize() {\n      this.url += usr_id;\n      this.fetch();\n    }\n  }); // -----------------------------------------\n  //             FRIENDS CARD VIEW\n  // -----------------------------------------\n\n  App.Views.UserFriends = Backbone.View.extend({\n    template: _.template($(\"#UserFriendsTemplate\").html()),\n    initialize: function initialize() {\n      this.collection.on('sync', this.renderIcons, this);\n    },\n    render: function render() {\n      var template = this.template();\n      this.$el.html(template);\n      $(\"#UserFriends\").html(this.el);\n      $(\"#accordionFlushExample\").css({\n        'display': 'none'\n      });\n      $(\"#UserFriendsCard\").css({\n        'border-bottom': '0px'\n      });\n      return this;\n    },\n    renderIcons: function renderIcons() {\n      this.n = 0;\n      this.collection.each(this.addOne, this);\n      return this;\n    },\n    addOne: function addOne(user) {\n      if (this.n < 6) {\n        icon = new App.Views.UserFriendsIcon({\n          model: user\n        });\n        icon.render();\n        $(\"#UserFriendsIcons\").append(icon.el);\n        this.n += 1;\n      } else if (this.n > 5) {\n        $(\"#accordionFlushExample\").css({\n          'display': 'block'\n        });\n        $(\"#UserFriendsCard\").css({\n          'border-bottom': '1px solid rgba(0, 0, 0, 0.125)'\n        });\n        icon = new App.Views.UserFriendsIcon({\n          model: user\n        });\n        icon.render();\n        $(\"#UserFriendsIconsAll\").append(icon.el);\n        this.n += 1;\n      }\n    }\n  }); // -----------------------------------------\n  //  FRIENDS      MODEL VIEW (ICON)\n  // -----------------------------------------\n\n  App.Views.UserFriendsIcon = Backbone.View.extend({\n    template: _.template($(\"#UserFriendsIconTemplate\").html()),\n    tagName: 'a',\n    className: 'col-2 UserFriendIcon SimpleHref',\n    render: function render() {\n      var template = this.template(this.model);\n      this.$el.attr({\n        'href': \"/profile/\" + this.model.id\n      });\n      this.$el.html(template);\n    }\n  }); // ---------------------------------------------------------------------------------------------------------------------------\n  //                                                  F O L L O W E R S\n  // ---------------------------------------------------------------------------------------------------------------------------\n  // -----------------------------------------\n  //  FOLLOWERS       MODEL and COLLECTION\n  // -----------------------------------------\n\n  App.Models.UserFollower = Backbone.Model.extend({\n    urlRoot: \"/friends/get_followers/\",\n    initialize: function initialize(data) {\n      this.urlRoot += usr_id;\n      if (typeof data.user === \"undefined\") return;\n      this.id = data.user.user_id;\n      this.nickname = data.user.nickname;\n      this.avatar = data.user.avatar;\n    }\n  });\n  App.Collections.UserFollowers = Backbone.Collection.extend({\n    model: App.Models.UserFollower,\n    url: \"/friends/get_followers/\",\n    initialize: function initialize() {\n      this.url += usr_id;\n      this.fetch();\n    }\n  }); // -----------------------------------------\n  //  FOLLOWERS     FRIEND REQUESTS CARD VIEW\n  // -----------------------------------------\n\n  App.Views.UserFriendRequests = Backbone.View.extend({\n    template: _.template($(\"#UserFriendRequestsTemplate\").html()),\n    initialize: function initialize() {\n      this.collection.on('sync', this.render, this);\n    },\n    render: function render() {\n      if (this.collection.length != 0) {\n        var template = this.template();\n        this.$el.html(template);\n        $(\"#UserFriendRequests\").html(this.el);\n        $(\"#UserFriendRequestsIconsFlash\").css({\n          'display': 'none'\n        });\n        $(\"#UserFriendRequestsCard\").css({\n          'border-bottom': '0px'\n        });\n        this.renderIcons();\n      }\n\n      return this;\n    },\n    renderIcons: function renderIcons() {\n      this.n = 0;\n      this.collection.each(this.addOne, this);\n      return this;\n    },\n    addOne: function addOne(user) {\n      if (this.n < 6) {\n        icon = new App.Views.UserFriendsIcon({\n          model: user\n        });\n        icon.render();\n        $(\"#UserFriendRequestsIcons\").append(icon.el);\n        this.n += 1;\n      } else if (this.n > 5) {\n        $(\"#accordionFlushExample\").css({\n          'display': 'block'\n        });\n        $(\"#UserFriendRequestsCard\").css({\n          'border-bottom': '1px solid rgba(0, 0, 0, 0.125)'\n        });\n        icon = new App.Views.UserFriendsIcon({\n          model: user\n        });\n        icon.render();\n        $(\"#UserFriendRequestsIconsAll\").append(icon.el);\n        this.n += 1;\n      }\n    }\n  }); // ---------------------------------------------------------------------------------------------------------------------------\n  //                                                  B L O C K L I S T\n  // ---------------------------------------------------------------------------------------------------------------------------\n  // -----------------------------------------\n  //  BLOCKLIST      MODEL and COLLECTION\n  // -----------------------------------------\n\n  App.Models.Blocklist = Backbone.Model.extend({\n    urlRoot: \"/profile/block_list_detailed/\",\n    initialize: function initialize(data) {\n      this.urlRoot += usr_id;\n      if (typeof data.blocked_user === \"undefined\") return;\n      this.id = data.blocked_user.blocked_user_id;\n      this.nickname = data.blocked_user.blocked_nickname;\n      this.avatar = data.blocked_user.blocked_avatar;\n      this.block_id = data.id;\n    }\n  });\n  App.Collections.Blocklist = Backbone.Collection.extend({\n    model: App.Models.Blocklist,\n    url: \"/profile/block_list_detailed/\",\n    initialize: function initialize() {\n      this.url += usr_id;\n      this.fetch();\n    }\n  }); // -----------------------------------------\n  //  BLOCKLIST    \tBLOCKLIST CARD VIEW\n  // -----------------------------------------\n\n  App.Views.UserBlocklist = Backbone.View.extend({\n    template: _.template($(\"#UserBlocklistTemplate\").html()),\n    initialize: function initialize() {\n      this.collection.on('sync', this.render, this);\n    },\n    render: function render() {\n      if (this.collection.length != 0) {\n        this.n = 0;\n        var template = this.template();\n        this.$el.html(template);\n        $(\"#UserBlocklist\").html(this.el);\n        $(\"#accordionFlushExample3\").css({\n          'display': 'none'\n        });\n        $(\"#UserBlocklistCard\").css({\n          'border-bottom': '0px'\n        });\n        this.collection.each(this.addOne, this);\n      }\n\n      return this;\n    },\n    addOne: function addOne(user) {\n      if (this.n < 3) {\n        icon = new App.Views.UserBlocklistIcon({\n          model: user\n        });\n        icon.render();\n        $(\"#UserBlocklistIcons\").append(icon.el);\n        $(\"#BlocklistHref\" + user.id).attr({\n          'href': \"/profile/\" + user.id\n        });\n        $(\"#BlocklistHrefName\" + user.id).attr({\n          'href': \"/profile/\" + user.id\n        });\n        this.n += 1;\n      } else if (this.n > 2) {\n        $(\"#accordionFlushExample3\").css({\n          'display': 'block'\n        });\n        $(\"#UserBlocklistCard\").css({\n          'border-bottom': '1px solid rgba(0, 0, 0, 0.125)'\n        });\n        icon = new App.Views.UserBlocklistIcon({\n          model: user\n        });\n        icon.render();\n        $(\"#UserBlocklistIconsAll\").append(icon.el);\n        $(\"#BlocklistHref\" + user.id).attr({\n          'href': \"/profile/\" + user.id\n        });\n        $(\"#BlocklistHrefName\" + user.id).attr({\n          'href': \"/profile/\" + user.id\n        });\n        this.n += 1;\n      }\n    }\n  }); // -----------------------------------------\n  //  BLOCKLIST      MODEL VIEW (ICON)\n  // -----------------------------------------\n\n  App.Views.UserBlocklistIcon = Backbone.View.extend({\n    template_list: _.template($(\"#BlocklistIconTemplate\").html()),\n    tagName: 'div',\n    className: 'row',\n    events: {\n      'click #UserUnblockBtn': 'unblockUser'\n    },\n    render: function render() {\n      var template_list = this.template_list(this.model);\n      this.$el.html(template_list);\n    },\n    unblockUser: function unblockUser() {\n      var _this = this;\n\n      fetch('/blocklists/unblock_user/' + this.model.block_id).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        alert('You unblocked ' + _this.model.nickname + '!');\n\n        _this.$el.remove();\n      }, this))[\"catch\"](function (res) {\n        alert(\"Error accured! Try again!\");\n      });\n    }\n  }); // ---------------------------------------------------------------------------------------------------------------------------\n  //                                                      G U I L D\n  // ---------------------------------------------------------------------------------------------------------------------------\n  // -----------------------------------------\n  //  GUILD_INVITES  MODEL and COLLECTION\n  // -----------------------------------------\n\n  App.Models.GuildInvite = Backbone.Model.extend({\n    urlRoot: \"/guild_invites/users_invites/\",\n    initialize: function initialize() {}\n  });\n  App.Collections.GuildInvites = Backbone.Collection.extend({\n    model: App.Models.GuildInvite,\n    url: \"/guild_invites/users_invites/\",\n    initialize: function initialize() {\n      this.url += current_user.id;\n    }\n  }); // -----------------------------------------\n  //  GUILD      \t\tGUILD CARD VIEW\n  // -----------------------------------------\n\n  App.Views.UserGuild = Backbone.View.extend({\n    template: _.template($(\"#UserGuildTemplate\").html()),\n    template_none: _.template($(\"#UserNoGuildTemplate\").html()),\n    initialize: function initialize(data) {\n      this.model = data.model;\n      this.invitesCollection = data.invitesCollection;\n    },\n    events: {\n      'click #UserInfoInviteBtn': 'inviteUser'\n    },\n    render: function render() {\n      var _this2 = this;\n\n      if (this.model.guild_id) {\n        fetch(\"/guilds/get_guild/\" + this.model.guild_id).then(function (res) {\n          return res.ok ? res.json() : Promise.reject(res);\n        }).then(_.bind(function (res) {\n          var template = _this2.template(res);\n\n          _this2.$el.html(template);\n\n          $(\"#UserGuild\").html(_this2.el);\n\n          _this2.drawInviteBtn();\n\n          _this2.drawInvitesList();\n        }, this));\n      } else {\n        var template = this.template_none();\n        this.$el.html(template);\n        $(\"#UserGuild\").html(this.el);\n        if (current_user.id == this.model.id) $(\"#inviteGuildBtn\").css({\n          \"display\": \"none\"\n        });else {\n          $(\"#guildInfo\").css({\n            \"display\": \"none\"\n          });\n          this.drawInviteBtn();\n        }\n        this.drawInvitesList();\n      }\n    },\n    drawInviteBtn: function drawInviteBtn() {\n      if (current_user.id != this.model.id && current_user.guild_id && current_user.guild_id != this.model.guild_id) {\n        $(\"#inviteGuildBtn\").css({\n          'display': 'block'\n        });\n      } else $(\"#inviteGuildBtn\").css({\n        \"display\": \"none\"\n      });\n    },\n    inviteUser: function inviteUser() {\n      fetch('/guild_invites/invite_to_guild/' + this.model.id).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        alert('You succesfully invited ' + this.model.nickname + ' to your guild!');\n      }, this))[\"catch\"](function () {\n        alert('Some error accured!');\n      });\n    },\n    drawInvitesList: function drawInvitesList() {\n      if (current_user.id != this.model.id) {\n        $(\"#accordionFlushGuild\").css({\n          \"display\": \"none\"\n        });\n        $(\"#UserGuildCard\").css({\n          'border-bottom': '0px solid rgba(0, 0, 0, 0.125)'\n        });\n      } else {\n        this.invitesCollection.fetch().then(_.bind(function () {\n          this.drawCollection();\n        }, this));\n      }\n    },\n    drawCollection: function drawCollection() {\n      if (this.invitesCollection.length != 0) {\n        this.invitesCollection.each(this.addOne, this);\n      } else {\n        $(\"#accordionFlushGuild\").css({\n          'display': 'none'\n        });\n        $(\"#UserGuildCard\").css({\n          'border-bottom': '0px solid rgba(0, 0, 0, 0.125)'\n        });\n      }\n    },\n    addOne: function addOne(invite) {\n      icon = new App.Views.UserGuildInvite({\n        model: invite,\n        guildView: this\n      });\n      icon.render();\n      $(\"#UserGuildInvites\").append(icon.el);\n    }\n  }); // -----------------------------------------\n  //  GUILD_INVITES      MODEL VIEW\n  // -----------------------------------------\n\n  App.Views.UserGuildInvite = Backbone.View.extend({\n    template_list: _.template($(\"#GuildInviteTemplate\").html()),\n    tagName: 'div',\n    className: 'row GuildInvitesList',\n    initialize: function initialize(data) {\n      this.model = data.model;\n      this.guildView = data.guildView;\n    },\n    events: {\n      'click #AcceptGuildInvitationBtn': 'AcceptInvitation',\n      'click #DeclineGuildInvitationBtn': 'DeclineInvitation'\n    },\n    render: function render() {\n      var template_list = this.template_list(this.model.attributes);\n      this.$el.html(template_list);\n    },\n    AcceptInvitation: function AcceptInvitation() {\n      var _this3 = this;\n\n      if (current_user.guild_id) {\n        if (confirm(\"You are already in guild. Are you sure that you want change the guild?\")) {\n          fetch(\"/guilds/exit\", {\n            method: \"POST\",\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(this.model)\n          }).then(_.bind(function () {\n            _this3.AcceptInvitationRequest();\n          }, this));\n        }\n      } else this.AcceptInvitationRequest();\n    },\n    AcceptInvitationRequest: function AcceptInvitationRequest() {\n      var _this4 = this;\n\n      fetch('/guild_invites/accept_invitation/' + this.model.get('id')).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        alert('You accepted invitation!');\n\n        _this4.$el.remove();\n\n        current_user.guild_id = _this4.model.attributes.guild.id;\n\n        _this4.guildView.render();\n      }, this))[\"catch\"](function (res) {\n        alert(\"Error accured! Try again!\");\n      });\n    },\n    DeclineInvitation: function DeclineInvitation() {\n      var _this5 = this;\n\n      fetch('/guild_invites/decline_invitation/' + this.model.get('id')).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        _this5.$el.remove();\n      }, this))[\"catch\"](function (res) {\n        alert(\"Error accured! Try again!\");\n      });\n    }\n  }); // ---------------------------------------------------------------------------------------------------------------------------\n  //                                             P R O F I L E      I N F O\n  // ---------------------------------------------------------------------------------------------------------------------------\n  // -----------------------------------------\n  //  USER           INFO CARD VIEW\n  // -----------------------------------------\n\n  App.Views.UserInfo = Backbone.View.extend({\n    template: _.template($(\"#UserInfoTemplate\").html()),\n    render: function render() {\n      var template = this.template(this.model);\n      this.$el.html(template);\n      $(\"#UserInfo\").html(this.el);\n      this.renderButtons();\n    },\n    renderButtons: function renderButtons() {\n      button = new App.Views.UserInfoBtn({\n        model: this.model\n      });\n      button.render();\n      block_button = new App.Views.UserBlockBtn({\n        model: this.model,\n        btns: button\n      });\n      block_button.render();\n    }\n  }); // -----------------------------------------\n  //  USER        INFO BUTTONS VIEW\n  // -----------------------------------------\n\n  App.Views.UserBlockBtn = Backbone.View.extend({\n    template: _.template($(\"#UserInfoBtnTemplate\").html()),\n    adm_template: _.template($(\"#UserInfoAdminBtnTemplate\").html()),\n    initialize: function initialize(data) {\n      this.model = data.model;\n      this.btns = data.btns;\n    },\n    events: {\n      'click #UserInfoBlockBtn': 'blockUser',\n      'click #UserInfoUnblockBtn': 'unblockUser',\n      'click #UserInfoBanBtn': 'banUser',\n      'click #UserInfoUnbanBtn': 'unbanUser',\n      'click #UserInfoDoModeratorBtn': 'doModeratorUser',\n      'click #UserInfoUndoModeratorBtn': 'undoModeratorUser'\n    },\n    render: function render() {\n      this.$el.html(\"\");\n\n      if (current_user.id != this.model.id) {\n        if (!this.model.is_admin) {\n          if ((current_user.is_admin == true || current_user.is_moderator == true) && !this.model.is_banned) this.$el.html(this.adm_template({\n            btn_title: \"Ban\",\n            btn_text: \"Ban user\"\n          }));else if ((current_user.is_admin == true || current_user.is_moderator == true) && this.model.is_banned) this.$el.html(this.adm_template({\n            btn_title: \"Unban\",\n            btn_text: \"Unban user\"\n          }));\n          if (current_user.is_admin == true && !this.model.is_moderator) this.$el.append(this.adm_template({\n            btn_title: \"DoModerator\",\n            btn_text: \"Do moderator\"\n          }));else if (current_user.is_admin == true && this.model.is_moderator) this.$el.append(this.adm_template({\n            btn_title: \"UndoModerator\",\n            btn_text: \"Undo moderator\"\n          }));\n        }\n\n        fetch('/blocklists/is_blocked/' + this.model.id).then(function (res) {\n          return res.ok ? res.json() : Promise.reject(res);\n        }).then(_.bind(function (res) {\n          if (res == 0) this.$el.append(this.template({\n            btn_title: \"Block\",\n            btn_text: \"Block user\"\n          }));else if (res == 1) this.$el.append(this.template({\n            btn_title: \"Unblock\",\n            btn_text: \"Unblock user\"\n          }));\n        }, this));\n        $('#BlockUnblockUser').html(this.el);\n      } else $(\"#LastBlockUserInfo\").css({\n        'display': 'none'\n      });\n    },\n    blockUser: function blockUser() {\n      var _this6 = this;\n\n      fetch('/blocklists/block_user/' + this.model.id).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        if (res == 1) alert('You blocked ' + _this6.model.nickname + '! Now he/she cannot send you messages!');\n\n        _this6.render();\n      }, this))[\"catch\"](function () {\n        return alert('some error');\n      });\n    },\n    unblockUser: function unblockUser() {\n      var _this7 = this;\n\n      fetch('/blocklists/unblock_user_by_id/' + this.model.id).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        if (res == 1) alert('You unblocked ' + _this7.model.nickname + '!');\n\n        _this7.render();\n      }, this))[\"catch\"](function () {\n        return alert('some error');\n      });\n    },\n    banUser: function banUser() {\n      var _this8 = this;\n\n      if (current_user.is_admin == true || current_user.is_moderator == true) {\n        fetch(\"/profile/ban_user/\" + this.model.id).then(function (res) {\n          return res.ok ? res.json() : Promise.reject(res);\n        }).then(_.bind(function (res) {\n          if (res == 1) alert('You banned ' + _this8.model.nickname + ' :(');else alert(res);\n          _this8.model.is_banned = true;\n\n          _this8.render();\n\n          _this8.btns.render();\n        }, this))[\"catch\"](function () {\n          return alert('some error');\n        });\n      } else alert(\"You don't have a permission!\");\n    },\n    unbanUser: function unbanUser() {\n      var _this9 = this;\n\n      if (current_user.is_admin == true || current_user.is_moderator == true) {\n        fetch(\"/profile/unban_user/\" + this.model.id).then(function (res) {\n          return res.ok ? res.json() : Promise.reject(res);\n        }).then(_.bind(function (res) {\n          if (res == 1) alert('You unbanned ' + _this9.model.nickname + ' :)');else alert(res);\n          _this9.model.is_banned = false;\n\n          _this9.render();\n\n          _this9.btns.render();\n        }, this))[\"catch\"](function () {\n          return alert('some error');\n        });\n      } else alert(\"You don't have a permission!\");\n    },\n    doModeratorUser: function doModeratorUser() {\n      var _this10 = this;\n\n      if (current_user.is_admin == true) {\n        fetch(\"/profile/do_moderator_user/\" + this.model.id).then(function (res) {\n          return res.ok ? res.json() : Promise.reject(res);\n        }).then(_.bind(function (res) {\n          if (res == 1) alert(_this10.model.nickname + ' is now a moderator! :)');else alert(res);\n          _this10.model.is_moderator = true;\n\n          _this10.render();\n\n          _this10.btns.render();\n        }, this))[\"catch\"](function () {\n          return alert('Some error accured!');\n        });\n      } else alert(\"You don't have a permission!\");\n    },\n    undoModeratorUser: function undoModeratorUser() {\n      var _this11 = this;\n\n      if (current_user.is_admin == true) {\n        fetch(\"/profile/undo_moderator_user/\" + this.model.id).then(function (res) {\n          return res.ok ? res.json() : Promise.reject(res);\n        }).then(_.bind(function (res) {\n          if (res == 1) alert(_this11.model.nickname + ' is not a moderator anymore!');else alert(res);\n          _this11.model.is_moderator = false;\n\n          _this11.render();\n\n          _this11.btns.render();\n        }, this))[\"catch\"](function () {\n          return alert('Some error accured!');\n        });\n      } else alert(\"You don't have a permission!\");\n    }\n  });\n  App.Views.UserInfoBtn = Backbone.View.extend({\n    id: 'UserButtons',\n    template: _.template($(\"#UserInfoBtnTemplate\").html()),\n    templateEditBtn: _.template($(\"#UserInfoEditBtnTemplate\").html()),\n    templateBannedStatus: _.template($(\"#UserInfoBannedStatusTemplate\").html()),\n    events: {\n      'click #UserInfoAddBtn': 'addFriend',\n      'click #UserInfoDelBtn': 'deleteFriend',\n      'click #UserInfoUnfollowBtn': 'unfollowUser',\n      'click #UserInfoFollowBackBtn': 'followBackUser',\n      'click #UserInfoSendBtn': 'sendMessage',\n      'click #UserInfoInviteBtn': 'inviteToGame'\n    },\n    render: function render() {\n      if (current_user.id == this.model.id) this.$el.html(this.templateEditBtn);else this.drawBtn();\n      $('#UserInfoBtn').html(this.el);\n    },\n    addFriend: function addFriend() {\n      var _this12 = this;\n\n      fetch(\"/friends/send_request/\" + this.model.id).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        if (res == 1) alert('You sent request to ' + _this12.model.nickname + '!');else alert(res);\n\n        _this12.render();\n      }, this));\n    },\n    followBackUser: function followBackUser() {\n      var _this13 = this;\n\n      fetch(\"/friends/follow_back/\" + this.model.id).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        if (res == 1) alert('You and ' + _this13.model.nickname + ' became friends!');\n\n        _this13.render();\n      }, this))[\"catch\"](function () {\n        return alert('some error');\n      });\n    },\n    deleteFriend: function deleteFriend() {\n      var _this14 = this;\n\n      fetch(\"/friends/delete_from_friends/\" + this.model.id).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        if (res == 1) alert('You deleted ' + _this14.model.nickname + ' from friends :(');else alert(res);\n\n        _this14.render();\n      }, this))[\"catch\"](function () {\n        return alert('some error');\n      });\n    },\n    unfollowUser: function unfollowUser() {\n      var _this15 = this;\n\n      fetch(\"/friends/unfollow_user/\" + this.model.id).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        if (res == 1) alert('You unfollowed ' + _this15.model.nickname + ' :(');else alert(res);\n\n        _this15.render();\n      }, this))[\"catch\"](function () {\n        return alert('some error');\n      });\n    },\n    sendMessage: function sendMessage() {\n      fetch(\"/rooms/create\", {\n        method: \"POST\",\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          name: this.model.nickname,\n          password: \"\"\n        })\n      }).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        window.location.href = \"/rooms/\" + res.id;\n      }, this))[\"catch\"](function () {\n        return alert('some error');\n      });\n    },\n    inviteToGame: function inviteToGame() {\n      var match = {\n        player2: usr_id\n      };\n      fetch(\"/new_match_profile/\" + usr_id + \".json\").then(function (res) {\n        return res.json();\n      }).then(_.bind(function (res) {\n        if (res.error) alert(res.error);else Turbolinks.visit(\"/matches/\" + res.id);\n      }, this));\n    },\n    drawBtn: function drawBtn() {\n      fetch(\"/friends/is_friend/\" + this.model.id).then(function (res) {\n        return res.ok ? res.json() : Promise.reject(res);\n      }).then(_.bind(function (res) {\n        if (this.model.is_banned) this.$el.html(this.templateBannedStatus);else this.$el.html(\"\");\n        this.$el.append(this.template({\n          btn_title: \"Send\",\n          btn_text: \"SEND MESSAGE\"\n        }));\n        this.$el.append(this.template({\n          btn_title: \"Invite\",\n          btn_text: \"INVITE TO GAME\"\n        }));\n        if (res == 0 && !this.model.is_banned) this.$el.append(this.template({\n          btn_title: \"Add\",\n          btn_text: \"ADD TO FRIENDS\"\n        }));else if (res == 1) this.$el.append(this.template({\n          btn_title: \"Del\",\n          btn_text: \"REMOVE FROM FRIENDS\"\n        }));else if (res == 2) this.$el.append(this.template({\n          btn_title: \"Unfollow\",\n          btn_text: \"UNFOLLOW\"\n        }));else if (!this.model.is_banned) this.$el.append(this.template({\n          btn_title: \"FollowBack\",\n          btn_text: \"FOLLOW BACK\"\n        }));\n      }, this));\n    }\n  }); // ---------------------------------------------------------------------------------------------------------------------------\n  //                                                   M A T C H E S\n  // ---------------------------------------------------------------------------------------------------------------------------\n\n  App.Models.UserMatches = Backbone.Model.extend({\n    urlRoot: '/matches/users_matches/',\n    initialize: function initialize() {\n      this.url += usr_id;\n    }\n  });\n  App.Collections.UserMatches = Backbone.Collection.extend({\n    url: '/matches/users_matches/',\n    initialize: function initialize() {\n      this.url += usr_id;\n      this.fetch();\n    }\n  }); // -----------------------------------------\n  //  USER      \t\tMATCHES CARD VIEW\n  // -----------------------------------------\n\n  App.Views.UserMatches = Backbone.View.extend({\n    template: _.template($(\"#UserMatchesTemplate\").html()),\n    initialize: function initialize(data) {\n      this.user = data.user;\n      this.collection = data.collection;\n      this.collection.on('sync', this.render, this);\n    },\n    render: function render() {\n      var template = this.template();\n      $(\"#UserMatches\").html(template);\n      this.n = 0;\n\n      if (this.collection.length <= 4) {\n        $(\"#accordionFlushMatches\").css({\n          'display': 'none'\n        });\n        $(\"#MatchesCard\").css({\n          'border-bottom': '0px'\n        });\n        if (this.collection.length == 0) $(\"#MacthesList\").html(\"No matches yet\");\n      }\n\n      this.collection.each(this.addOne, this);\n      return this;\n    },\n    addOne: function addOne(match) {\n      if (this.n <= 4) {\n        var row = new App.Views.UserMatch({\n          model: match\n        });\n        $(\"#MacthesList\").append(row.render().el);\n        this.n += 1;\n      } else {\n        var row = new App.Views.UserMatch({\n          model: match\n        });\n        $(\"#MacthesListAll\").append(row.render().el);\n        this.n += 1;\n      }\n    }\n  });\n  App.Views.UserMatch = Backbone.View.extend({\n    template: _.template($(\"#MatchesRowTemplate\").html()),\n    className: 'row',\n    render: function render() {\n      this.model.attributes.status = \"future\";\n      if (this.model.attributes.is_end) this.model.attributes.status = \"end\";else if (this.model.attributes.is_inprogress) this.model.attributes.status = \"now\";\n      this.$el.html(this.template(this.model.attributes));\n      return this;\n    }\n  }); //------------------------------------------------------------------------\n  //\tCHANGE ONLINE STATUS\n  //------------------------------------------------------------------------\n\n  var OnlineUsersModel = Backbone.Model.extend({\n    urlRoot: \"/users/online\"\n  });\n  var OnlineUsersCollection = Backbone.Collection.extend({\n    url: \"/users/online\",\n    model: OnlineUsersModel,\n    initialize: function initialize(current_user_id, profile_id) {\n      var _this16 = this;\n\n      _.bindAll(this, 'online');\n\n      this.profile_id = profile_id;\n      this.current_user_id = current_user_id;\n      this.fetch({\n        success: function success() {\n          _this16.online();\n        }\n      });\n    },\n    online: function online() {\n      var _this17 = this;\n\n      this.each(function (friend) {\n        $(\"#ProfileOnlineStatus\".concat(_this17.current_user_id)).css(\"color\", \"#0ec82d\");\n        $(\"#ProfileOnlineStatus\".concat(_this17.current_user_id)).html(\"online\");\n        $(\"#FriendOnlineStatus\".concat(friend.get(\"id\"))).css(\"background\", \"#0ec82d\");\n\n        if (friend.get(\"id\") == _this17.profile_id) {\n          $(\"#ProfileOnlineStatus\".concat(_this17.profile_id)).css(\"color\", \"#0ec82d\");\n          $(\"#ProfileOnlineStatus\".concat(_this17.profile_id)).html(\"online\");\n        }\n      });\n    }\n  }); // ---------------------------------------------------------------------------------------------------------------------------\n  //                                                    M A I N\n  // ---------------------------------------------------------------------------------------------------------------------------\n\n  var urlArray = window.jQuery.ajaxSettings.url.split('/');\n  var user_id = urlArray[urlArray.length - 1];\n  fetch(\"/profile/get_curr_user\").then(function (res) {\n    return res.ok ? res.json() : Promise.reject(res);\n  }).then(function (res) {\n    window.current_user = new App.Models.User({\n      user: res\n    });\n\n    if (user_id == current_user.id || user_id == 0) {\n      user = current_user;\n      renderPage(user);\n    } else {\n      fetch(\"/profile/get_user/\" + user_id).then(function (result) {\n        return result.ok ? result.json() : Promise.reject(result);\n      }).then(function (result) {\n        user = new App.Models.User({\n          user: result\n        });\n        renderPage(user);\n      });\n    }\n  });\n\n  function renderPage(user) {\n    if (!current_user.is_banned) {\n      window.usr_id = user.id;\n      userInfoView = new App.Views.UserInfo({\n        model: user\n      });\n      userInfoView.render();\n      UserFriends = new App.Collections.UserFriends();\n      UserFriendsView = new App.Views.UserFriends({\n        collection: UserFriends\n      });\n      UserFriendsView.render();\n\n      if (user.id == current_user.id) {\n        UserFriendRequests = new App.Collections.UserFollowers();\n        UserFriendRequestsView = new App.Views.UserFriendRequests({\n          collection: UserFriendRequests\n        });\n      }\n\n      InvitesCollection = new App.Collections.GuildInvites();\n      UserGuildView = new App.Views.UserGuild({\n        model: user,\n        invitesCollection: InvitesCollection\n      });\n      UserGuildView.render();\n      UserMatches = new App.Collections.UserMatches();\n      UserMatchesView = new App.Views.UserMatches({\n        user: user,\n        collection: UserMatches\n      });\n      UserMatchesView.render();\n\n      if (user.id == current_user.id) {\n        UserBlocklist = new App.Collections.Blocklist();\n        UserBlocklistView = new App.Views.UserBlocklist({\n          collection: UserBlocklist\n        });\n      }\n\n      setTimeout(function () {\n        new OnlineUsersCollection(current_user.id, user_id);\n      }, 1500);\n    } else $(\".content\").html(\"<h3>You account was blocked by administrator</h3>\");\n  }\n}());","map":{"version":3,"sources":["/pingpong/app/javascript/packs/user.js"],"names":["require","template","$","window","App","Models","Views","Collections","Router","User","Backbone","Model","extend","initialize","data","id","user","nickname","avatar","email","guild_id","loses","wins","score","is_banned","is_admin","is_moderator","UserFriend","urlRoot","usr_id","friend","friend_id","UserFriends","Collection","model","url","fetch","View","_","html","collection","on","renderIcons","render","$el","el","css","n","each","addOne","icon","UserFriendsIcon","append","tagName","className","attr","UserFollower","user_id","UserFollowers","UserFriendRequests","length","Blocklist","blocked_user","blocked_user_id","blocked_nickname","blocked_avatar","block_id","UserBlocklist","UserBlocklistIcon","template_list","events","unblockUser","then","res","ok","json","Promise","reject","bind","alert","remove","GuildInvite","GuildInvites","current_user","UserGuild","template_none","invitesCollection","drawInviteBtn","drawInvitesList","inviteUser","drawCollection","invite","UserGuildInvite","guildView","attributes","AcceptInvitation","confirm","method","headers","body","JSON","stringify","AcceptInvitationRequest","get","guild","DeclineInvitation","UserInfo","renderButtons","button","UserInfoBtn","block_button","UserBlockBtn","btns","adm_template","btn_title","btn_text","blockUser","banUser","unbanUser","doModeratorUser","undoModeratorUser","templateEditBtn","templateBannedStatus","drawBtn","addFriend","followBackUser","deleteFriend","unfollowUser","sendMessage","name","password","location","href","inviteToGame","match","player2","error","Turbolinks","visit","UserMatches","row","UserMatch","status","is_end","is_inprogress","OnlineUsersModel","OnlineUsersCollection","current_user_id","profile_id","bindAll","success","online","urlArray","jQuery","ajaxSettings","split","renderPage","result","userInfoView","UserFriendsView","UserFriendRequestsView","InvitesCollection","UserGuildView","UserMatchesView","UserBlocklistView","setTimeout"],"mappings":"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","sourcesContent":["const { template } = require(\"underscore\");\n\n$(function () {\n\n\twindow.App = {\n\t\tModels: {},\n\t\tViews: {},\n\t\tCollections: {},\n\t\tRouter: {}\n\t};\n\n\n// -----------------------------------------\n//  USER              MODEL\n// -----------------------------------------\n\tApp.Models.User = Backbone.Model.extend({\n\t\tinitialize: function (data) {\n\t\t\tthis.id = data.user.id\n\t\t\tthis.nickname = data.user.nickname\n\t\t\tthis.avatar = data.user.avatar\n\t\t\tthis.email = data.user.email\n\t\t\tthis.guild_id = data.user.guild_id\n\t\t\tthis.loses = data.user.loses\n\t\t\tthis.wins = data.user.wins\n\t\t\tthis.score = data.user.score\n\t\t\tthis.is_banned = data.user.is_banned\n\t\t\tthis.is_admin = data.user.is_admin\n\t\t\tthis.is_moderator = data.user.is_moderator\n\t\t}\n\t})\n\n\n// ---------------------------------------------------------------------------------------------------------------------------\n//                                                   F R I E N D S\n// ---------------------------------------------------------------------------------------------------------------------------\n\n\t// -----------------------------------------\n\t//  FRIENDS       MODEL and COLLECTION\n\t// -----------------------------------------\n\tApp.Models.UserFriend = Backbone.Model.extend({\n\t\turlRoot: \"/friends/get_friends/\",\n\t\tinitialize: function (data) {\n\t\t\tthis.urlRoot += usr_id\n\t\t\tif (typeof data.friend === \"undefined\")\n\t\t\t\treturn;\n\t\t\tthis.id = data.friend.friend_id\n\t\t\tthis.nickname = data.friend.nickname\n\t\t\tthis.avatar = data.friend.avatar\n\t\t}\n\t})\n\n\tApp.Collections.UserFriends = Backbone.Collection.extend({\n\t\tmodel: App.Models.UserFriend,\n\t\turl: \"/friends/get_friends/\",\n\t\tinitialize: function () {\n\t\t\tthis.url += usr_id\n\t\t\tthis.fetch()\n\t\t}\n\t})\n\n\t// -----------------------------------------\n\t//             FRIENDS CARD VIEW\n\t// -----------------------------------------\n\tApp.Views.UserFriends = Backbone.View.extend({\n\t\ttemplate: _.template($(\"#UserFriendsTemplate\").html()),\n\t\tinitialize: function () {\n\t\t\tthis.collection.on('sync', this.renderIcons, this)\n\t\t},\n\t\trender: function () {\n\t\t\tvar template = this.template()\n\t\t\tthis.$el.html(template)\n\t\t\t$(\"#UserFriends\").html(this.el)\n\t\t\t$(\"#accordionFlushExample\").css({ 'display': 'none' })\n\t\t\t$(\"#UserFriendsCard\").css({ 'border-bottom': '0px' })\n\t\t\treturn this\n\t\t},\n\t\trenderIcons: function () {\n\t\t\tthis.n = 0\n\t\t\tthis.collection.each(this.addOne, this)\n\t\t\treturn this\n\t\t},\n\t\taddOne: function (user) {\n\t\t\tif (this.n < 6) {\n\t\t\t\ticon = new App.Views.UserFriendsIcon({ model: user })\n\t\t\t\ticon.render()\n\t\t\t\t$(\"#UserFriendsIcons\").append(icon.el);\n\t\t\t\tthis.n += 1\n\t\t\t}\n\t\t\telse if (this.n > 5) {\n\t\t\t\t$(\"#accordionFlushExample\").css({ 'display': 'block' })\n\t\t\t\t$(\"#UserFriendsCard\").css({ 'border-bottom': '1px solid rgba(0, 0, 0, 0.125)' })\n\t\t\t\ticon = new App.Views.UserFriendsIcon({ model: user })\n\t\t\t\ticon.render()\n\t\t\t\t$(\"#UserFriendsIconsAll\").append(icon.el);\n\t\t\t\tthis.n += 1\n\t\t\t}\n\t\t},\n\t})\n\n\t// -----------------------------------------\n\t//  FRIENDS      MODEL VIEW (ICON)\n\t// -----------------------------------------\n\tApp.Views.UserFriendsIcon = Backbone.View.extend({\n\t\ttemplate: _.template($(\"#UserFriendsIconTemplate\").html()),\n\t\ttagName: 'a',\n\t\tclassName: 'col-2 UserFriendIcon SimpleHref',\n\t\trender: function () {\n\t\t\tvar template = this.template(this.model);\n\n\t\t\tthis.$el.attr({ 'href': (\"/profile/\" + this.model.id) });\n\t\t\tthis.$el.html(template);\n\t\t}\n\t})\n\n\n\n// ---------------------------------------------------------------------------------------------------------------------------\n//                                                  F O L L O W E R S\n// ---------------------------------------------------------------------------------------------------------------------------\n\n\t// -----------------------------------------\n\t//  FOLLOWERS       MODEL and COLLECTION\n\t// -----------------------------------------\n\tApp.Models.UserFollower = Backbone.Model.extend({\n\t\turlRoot: \"/friends/get_followers/\",\n\t\tinitialize: function (data) {\n\t\t\tthis.urlRoot += usr_id\n\t\t\tif (typeof data.user === \"undefined\")\n\t\t\t\treturn;\n\t\t\tthis.id = data.user.user_id\n\t\t\tthis.nickname = data.user.nickname\n\t\t\tthis.avatar = data.user.avatar\n\t\t}\n\t})\n\n\tApp.Collections.UserFollowers = Backbone.Collection.extend({\n\t\tmodel: App.Models.UserFollower,\n\t\turl: \"/friends/get_followers/\",\n\t\tinitialize: function () {\n\t\t\tthis.url += usr_id\n\t\t\tthis.fetch()\n\t\t}\n\t})\n\n\t// -----------------------------------------\n\t//  FOLLOWERS     FRIEND REQUESTS CARD VIEW\n\t// -----------------------------------------\n\tApp.Views.UserFriendRequests = Backbone.View.extend({\n\t\ttemplate: _.template($(\"#UserFriendRequestsTemplate\").html()),\n\t\tinitialize: function () {\n\t\t\tthis.collection.on('sync', this.render, this)\n\t\t},\n\t\trender: function () {\n\t\t\tif (this.collection.length != 0) {\n\t\t\t\tvar template = this.template()\n\t\t\t\tthis.$el.html(template)\n\t\t\t\t$(\"#UserFriendRequests\").html(this.el)\n\t\t\t\t$(\"#UserFriendRequestsIconsFlash\").css({ 'display': 'none' })\n\t\t\t\t$(\"#UserFriendRequestsCard\").css({ 'border-bottom': '0px' })\n\t\t\t\tthis.renderIcons()\n\t\t\t}\n\t\t\treturn this\n\t\t},\n\t\trenderIcons: function () {\n\t\t\tthis.n = 0\n\t\t\tthis.collection.each(this.addOne, this)\n\t\t\treturn this\n\t\t},\n\t\taddOne: function (user) {\n\t\t\tif (this.n < 6) {\n\t\t\t\ticon = new App.Views.UserFriendsIcon({ model: user })\n\t\t\t\ticon.render()\n\t\t\t\t$(\"#UserFriendRequestsIcons\").append(icon.el);\n\t\t\t\tthis.n += 1\n\t\t\t}\n\t\t\telse if (this.n > 5) {\n\t\t\t\t$(\"#accordionFlushExample\").css({ 'display': 'block' })\n\t\t\t\t$(\"#UserFriendRequestsCard\").css({ 'border-bottom': '1px solid rgba(0, 0, 0, 0.125)' })\n\t\t\t\ticon = new App.Views.UserFriendsIcon({ model: user })\n\t\t\t\ticon.render()\n\t\t\t\t$(\"#UserFriendRequestsIconsAll\").append(icon.el);\n\t\t\t\tthis.n += 1\n\t\t\t}\n\t\t},\n\t})\n\n\n// ---------------------------------------------------------------------------------------------------------------------------\n//                                                  B L O C K L I S T\n// ---------------------------------------------------------------------------------------------------------------------------\n\n\t// -----------------------------------------\n\t//  BLOCKLIST      MODEL and COLLECTION\n\t// -----------------------------------------\n\tApp.Models.Blocklist = Backbone.Model.extend({\n\t\turlRoot: \"/profile/block_list_detailed/\",\n\t\tinitialize: function (data) {\n\t\t\tthis.urlRoot += usr_id\n\t\t\tif (typeof data.blocked_user === \"undefined\")\n\t\t\t\treturn;\n\t\t\tthis.id = data.blocked_user.blocked_user_id\n\t\t\tthis.nickname = data.blocked_user.blocked_nickname\n\t\t\tthis.avatar = data.blocked_user.blocked_avatar\n\t\t\tthis.block_id = data.id\n\t\t}\n\t})\n\n\tApp.Collections.Blocklist = Backbone.Collection.extend({\n\t\tmodel: App.Models.Blocklist,\n\t\turl: \"/profile/block_list_detailed/\",\n\t\tinitialize: function () {\n\t\t\tthis.url += usr_id\n\t\t\tthis.fetch()\n\t\t}\n\t})\n\n\t// -----------------------------------------\n\t//  BLOCKLIST    \tBLOCKLIST CARD VIEW\n\t// -----------------------------------------\n\tApp.Views.UserBlocklist = Backbone.View.extend({\n\t\ttemplate: _.template($(\"#UserBlocklistTemplate\").html()),\n\t\tinitialize: function () {\n\t\t\tthis.collection.on('sync', this.render, this)\n\t\t},\n\t\trender: function () {\n\t\t\tif (this.collection.length != 0) {\n\t\t\t\tthis.n = 0\n\t\t\t\tvar template = this.template();\n\t\t\t\tthis.$el.html(template);\n\t\t\t\t$(\"#UserBlocklist\").html(this.el)\n\t\t\t\t$(\"#accordionFlushExample3\").css({ 'display': 'none' })\n\t\t\t\t$(\"#UserBlocklistCard\").css({ 'border-bottom': '0px' })\n\t\t\t\tthis.collection.each(this.addOne, this)\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\taddOne: function (user) {\n\t\t\tif (this.n < 3) {\n\t\t\t\ticon = new App.Views.UserBlocklistIcon({ model: user })\n\t\t\t\ticon.render()\n\t\t\t\t$(\"#UserBlocklistIcons\").append(icon.el);\n\t\t\t\t$(\"#BlocklistHref\" + user.id).attr({ 'href': (\"/profile/\" + user.id) });\n\t\t\t\t$(\"#BlocklistHrefName\" + user.id).attr({ 'href': (\"/profile/\" + user.id) });\n\t\t\t\tthis.n += 1\n\t\t\t}\n\t\t\telse if (this.n > 2) {\n\t\t\t\t$(\"#accordionFlushExample3\").css({ 'display': 'block' })\n\t\t\t\t$(\"#UserBlocklistCard\").css({ 'border-bottom': '1px solid rgba(0, 0, 0, 0.125)' })\n\t\t\t\ticon = new App.Views.UserBlocklistIcon({ model: user })\n\t\t\t\ticon.render()\n\t\t\t\t$(\"#UserBlocklistIconsAll\").append(icon.el);\n\t\t\t\t$(\"#BlocklistHref\" + user.id).attr({ 'href': (\"/profile/\" + user.id) });\n\t\t\t\t$(\"#BlocklistHrefName\" + user.id).attr({ 'href': (\"/profile/\" + user.id) });\n\t\t\t\tthis.n += 1\n\t\t\t}\n\t\t},\n\t})\n\n\t// -----------------------------------------\n\t//  BLOCKLIST      MODEL VIEW (ICON)\n\t// -----------------------------------------\n\n\tApp.Views.UserBlocklistIcon = Backbone.View.extend({\n\t\ttemplate_list: _.template($(\"#BlocklistIconTemplate\").html()),\n\t\ttagName: 'div',\n\t\tclassName: 'row',\n\t\tevents: {\n\t\t\t'click #UserUnblockBtn': 'unblockUser'\n\t\t},\n\t\trender: function () {\n\t\t\tvar template_list = this.template_list(this.model);\n\t\t\tthis.$el.html(template_list);\n\t\t},\n\t\tunblockUser: function () {\n\t\t\tfetch(('/blocklists/unblock_user/' + this.model.block_id))\n\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t.then(_.bind((res) => {\n\t\t\t\t\talert('You unblocked ' + this.model.nickname + '!');\n\t\t\t\t\tthis.$el.remove();\n\t\t\t\t}, this))\n\t\t\t\t.catch(function (res) {\n\t\t\t\t\talert(\"Error accured! Try again!\")\n\t\t\t\t})\n\t\t}\n\t})\n\n\n// ---------------------------------------------------------------------------------------------------------------------------\n//                                                      G U I L D\n// ---------------------------------------------------------------------------------------------------------------------------\n\n\t// -----------------------------------------\n\t//  GUILD_INVITES  MODEL and COLLECTION\n\t// -----------------------------------------\n\tApp.Models.GuildInvite = Backbone.Model.extend({\n\t\turlRoot: \"/guild_invites/users_invites/\",\n\t\tinitialize: function () {\n\t\t}\n\t})\n\n\tApp.Collections.GuildInvites = Backbone.Collection.extend({\n\t\tmodel: App.Models.GuildInvite,\n\t\turl: \"/guild_invites/users_invites/\",\n\t\tinitialize: function () {\n\t\t\tthis.url += current_user.id\n\t\t}\n\t})\n\n\t// -----------------------------------------\n\t//  GUILD      \t\tGUILD CARD VIEW\n\t// -----------------------------------------\n\tApp.Views.UserGuild = Backbone.View.extend({\n\t\ttemplate: _.template($(\"#UserGuildTemplate\").html()),\n\t\ttemplate_none: _.template($(\"#UserNoGuildTemplate\").html()),\n\t\tinitialize: function (data) {\n\t\t\tthis.model = data.model\n\t\t\tthis.invitesCollection = data.invitesCollection\n\t\t},\n\t\tevents: {\n\t\t\t'click #UserInfoInviteBtn': 'inviteUser',\n\t\t},\n\t\trender: function () {\n\t\t\tif (this.model.guild_id) {\n\t\t\t\tfetch((\"/guilds/get_guild/\" + this.model.guild_id))\n\t\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t\t.then(_.bind(res => {\n\t\t\t\t\t\tvar template = this.template(res);\n\t\t\t\t\t\tthis.$el.html(template);\n\t\t\t\t\t\t$(\"#UserGuild\").html(this.el)\n\t\t\t\t\t\tthis.drawInviteBtn()\n\t\t\t\t\t\tthis.drawInvitesList()\n\t\t\t\t\t}, this))\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar template = this.template_none()\n\t\t\t\tthis.$el.html(template)\n\t\t\t\t$(\"#UserGuild\").html(this.el)\n\t\t\t\tif (current_user.id == this.model.id)\n\t\t\t\t\t$(\"#inviteGuildBtn\").css({ \"display\": \"none\" })\n\t\t\t\telse {\n\t\t\t\t\t$(\"#guildInfo\").css({ \"display\": \"none\" })\n\t\t\t\t\tthis.drawInviteBtn()\n\t\t\t\t}\n\t\t\t\tthis.drawInvitesList()\n\t\t\t}\n\t\t},\n\t\tdrawInviteBtn: function () {\n\t\t\tif ((current_user.id != this.model.id) &&\n\t\t\t\t(current_user.guild_id) &&\n\t\t\t\t(current_user.guild_id != this.model.guild_id)) {\n\t\t\t\t$(\"#inviteGuildBtn\").css({ 'display': 'block' })\n\t\t\t}\n\t\t\telse\n\t\t\t\t$(\"#inviteGuildBtn\").css({ \"display\": \"none\" })\n\t\t},\n\t\tinviteUser: function () {\n\t\t\tfetch(('/guild_invites/invite_to_guild/' + this.model.id))\n\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t.then(_.bind(function (res) {\n\t\t\t\t\talert('You succesfully invited ' + this.model.nickname + ' to your guild!')\n\t\t\t\t}, this))\n\t\t\t\t.catch(() => {\n\t\t\t\t\talert('Some error accured!')\n\t\t\t\t})\n\t\t},\n\t\tdrawInvitesList: function () {\n\t\t\tif (current_user.id != this.model.id) {\n\t\t\t\t$(\"#accordionFlushGuild\").css({ \"display\": \"none\" })\n\t\t\t\t$(\"#UserGuildCard\").css({ 'border-bottom': '0px solid rgba(0, 0, 0, 0.125)' })\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.invitesCollection.fetch()\n\t\t\t\t\t.then(_.bind(function () {\n\t\t\t\t\t\tthis.drawCollection()\n\t\t\t\t\t}, this))\n\t\t\t}\n\t\t},\n\t\tdrawCollection: function () {\n\t\t\tif (this.invitesCollection.length != 0) {\n\t\t\t\tthis.invitesCollection.each(this.addOne, this)\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$(\"#accordionFlushGuild\").css({ 'display': 'none' })\n\t\t\t\t$(\"#UserGuildCard\").css({ 'border-bottom': '0px solid rgba(0, 0, 0, 0.125)' })\n\t\t\t}\n\t\t},\n\t\taddOne: function (invite) {\n\t\t\ticon = new App.Views.UserGuildInvite({ model: invite, guildView: this })\n\t\t\ticon.render()\n\t\t\t$(\"#UserGuildInvites\").append(icon.el);\n\t\t}\n\t})\n\n\t// -----------------------------------------\n\t//  GUILD_INVITES      MODEL VIEW\n\t// -----------------------------------------\n\n\tApp.Views.UserGuildInvite = Backbone.View.extend({\n\t\ttemplate_list: _.template($(\"#GuildInviteTemplate\").html()),\n\t\ttagName: 'div',\n\t\tclassName: 'row GuildInvitesList',\n\t\tinitialize: function (data) {\n\t\t\tthis.model = data.model;\n\t\t\tthis.guildView = data.guildView;\n\t\t},\n\t\tevents: {\n\t\t\t'click #AcceptGuildInvitationBtn': 'AcceptInvitation',\n\t\t\t'click #DeclineGuildInvitationBtn': 'DeclineInvitation'\n\t\t},\n\t\trender: function () {\n\t\t\tvar template_list = this.template_list(this.model.attributes);\n\t\t\tthis.$el.html(template_list);\n\t\t},\n\t\tAcceptInvitation: function () {\n\t\t\tif (current_user.guild_id) {\n\t\t\t\tif (confirm(\"You are already in guild. Are you sure that you want change the guild?\")) {\n\t\t\t\t\tfetch(\"/guilds/exit\", {\n\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Accept': 'application/json',\n\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbody: JSON.stringify(this.model)\n\t\t\t\t\t})\n\t\t\t\t\t.then(_.bind(() => {\n\t\t\t\t\t\tthis.AcceptInvitationRequest()\n\t\t\t\t\t}, this))\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tthis.AcceptInvitationRequest()\n\t\t},\n\t\tAcceptInvitationRequest: function () {\n\t\t\tfetch(('/guild_invites/accept_invitation/' + this.model.get('id')))\n\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t.then(_.bind((res) => {\n\t\t\t\t\talert('You accepted invitation!');\n\t\t\t\t\tthis.$el.remove();\n\t\t\t\t\tcurrent_user.guild_id = this.model.attributes.guild.id\n\t\t\t\t\tthis.guildView.render()\n\t\t\t\t}, this))\n\t\t\t\t.catch(function (res) {\n\t\t\t\t\talert(\"Error accured! Try again!\")\n\t\t\t\t})\n\t\t},\n\t\tDeclineInvitation: function () {\n\t\t\tfetch(('/guild_invites/decline_invitation/' + this.model.get('id')))\n\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t.then(_.bind((res) => {\n\t\t\t\t\tthis.$el.remove();\n\t\t\t\t}, this))\n\t\t\t\t.catch(function (res) {\n\t\t\t\t\talert(\"Error accured! Try again!\")\n\t\t\t\t})\n\t\t}\n\t})\n\n\n// ---------------------------------------------------------------------------------------------------------------------------\n//                                             P R O F I L E      I N F O\n// ---------------------------------------------------------------------------------------------------------------------------\n\n\t// -----------------------------------------\n\t//  USER           INFO CARD VIEW\n\t// -----------------------------------------\n\tApp.Views.UserInfo = Backbone.View.extend({\n\t\ttemplate: _.template($(\"#UserInfoTemplate\").html()),\n\t\trender: function () {\n\t\t\tvar template = this.template(this.model)\n\t\t\tthis.$el.html(template)\n\t\t\t$(\"#UserInfo\").html(this.el)\n\t\t\tthis.renderButtons()\n\t\t},\n\t\trenderButtons: function () {\n\t\t\tbutton = new App.Views.UserInfoBtn({ model: this.model })\n\t\t\tbutton.render()\n\t\t\tblock_button = new App.Views.UserBlockBtn({ model: this.model, btns: button})\n\t\t\tblock_button.render()\n\t\t}\n\t})\n\n\t// -----------------------------------------\n\t//  USER        INFO BUTTONS VIEW\n\t// -----------------------------------------\n\tApp.Views.UserBlockBtn = Backbone.View.extend({\n\t\ttemplate:\t\t_.template($(\"#UserInfoBtnTemplate\").html()),\n\t\tadm_template:\t_.template($(\"#UserInfoAdminBtnTemplate\").html()),\n\t\tinitialize: function (data) {\n\t\t\tthis.model = data.model\n\t\t\tthis.btns = data.btns\n\t\t},\n\t\tevents: {\n\t\t\t'click #UserInfoBlockBtn':\t\t\t'blockUser',\n\t\t\t'click #UserInfoUnblockBtn':\t\t'unblockUser',\n\n\t\t\t'click #UserInfoBanBtn': \t\t\t'banUser',\n\t\t\t'click #UserInfoUnbanBtn': \t\t\t'unbanUser',\n\n\t\t\t'click #UserInfoDoModeratorBtn': \t'doModeratorUser',\n\t\t\t'click #UserInfoUndoModeratorBtn': \t'undoModeratorUser',\n\t\t},\n\t\trender: function () {\n\t\t\tthis.$el.html(\"\")\n\t\t\tif (current_user.id != this.model.id) {\n\t\t\t\tif (!this.model.is_admin) {\n\t\t\t\t\tif ((current_user.is_admin == true || current_user.is_moderator == true) && !this.model.is_banned)\n\t\t\t\t\t\tthis.$el.html(this.adm_template({ btn_title: \"Ban\", btn_text: \"Ban user\" }));\n\t\t\t\t\telse if ((current_user.is_admin == true || current_user.is_moderator == true) && this.model.is_banned)\n\t\t\t\t\t\tthis.$el.html(this.adm_template({ btn_title: \"Unban\", btn_text: \"Unban user\" }));\n\t\t\t\t\tif (current_user.is_admin == true && !this.model.is_moderator)\n\t\t\t\t\t\tthis.$el.append(this.adm_template({ btn_title: \"DoModerator\", btn_text: \"Do moderator\" }));\n\t\t\t\t\telse if (current_user.is_admin == true && this.model.is_moderator)\n\t\t\t\t\t\tthis.$el.append(this.adm_template({ btn_title: \"UndoModerator\", btn_text: \"Undo moderator\" }));\n\t\t\t\t}\n\t\t\t\tfetch(('/blocklists/is_blocked/' + this.model.id))\n\t\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t\t.then(_.bind(function (res) {\n\t\t\t\t\t\tif (res == 0)\n\t\t\t\t\t\t\tthis.$el.append(this.template({ btn_title: \"Block\", btn_text: \"Block user\" }));\n\t\t\t\t\t\telse if (res == 1)\n\t\t\t\t\t\t\tthis.$el.append(this.template({ btn_title: \"Unblock\", btn_text: \"Unblock user\" }));\n\t\t\t\t\t}, this))\n\t\t\t\t$('#BlockUnblockUser').html(this.el)\n\t\t\t}\n\t\t\telse\n\t\t\t\t$(\"#LastBlockUserInfo\").css({'display': 'none'})\n\t\t},\n\t\tblockUser: function () {\n\t\t\tfetch(('/blocklists/block_user/' + this.model.id))\n\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t.then(_.bind((res) => {\n\t\t\t\t\tif (res == 1)\n\t\t\t\t\t\talert('You blocked ' + this.model.nickname + '! Now he/she cannot send you messages!')\n\t\t\t\t\tthis.render()\n\t\t\t\t}, this))\n\t\t\t\t.catch(() => alert('some error'));\n\t\t},\n\t\tunblockUser: function () {\n\t\t\tfetch(('/blocklists/unblock_user_by_id/' + this.model.id))\n\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t.then(_.bind((res) => {\n\t\t\t\t\tif (res == 1)\n\t\t\t\t\t\talert('You unblocked ' + this.model.nickname + '!')\n\t\t\t\t\tthis.render()\n\t\t\t\t}, this))\n\t\t\t\t.catch(() => alert('some error'));\n\t\t},\n\t\tbanUser: function () {\n\t\t\tif (current_user.is_admin == true || current_user.is_moderator == true) {\n\t\t\t\tfetch((\"/profile/ban_user/\" + this.model.id))\n\t\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t\t.then(_.bind((res) => {\n\t\t\t\t\t\tif (res == 1)\n\t\t\t\t\t\t\talert('You banned ' + this.model.nickname + ' :(')\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\talert(res)\n\t\t\t\t\t\tthis.model.is_banned = true;\n\t\t\t\t\t\tthis.render()\n\t\t\t\t\t\tthis.btns.render()\n\t\t\t\t\t}, this))\n\t\t\t\t\t.catch(() => alert('some error'));\n\t\t\t}\n\t\t\telse\n\t\t\t\talert(\"You don't have a permission!\")\n\t\t},\n\t\tunbanUser: function () {\n\t\t\tif (current_user.is_admin == true || current_user.is_moderator == true) {\n\t\t\t\tfetch((\"/profile/unban_user/\" + this.model.id))\n\t\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t\t.then(_.bind((res) => {\n\t\t\t\t\t\tif (res == 1)\n\t\t\t\t\t\t\talert('You unbanned ' + this.model.nickname + ' :)')\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\talert(res)\n\t\t\t\t\t\tthis.model.is_banned = false;\n\t\t\t\t\t\tthis.render()\n\t\t\t\t\t\tthis.btns.render()\n\t\t\t\t\t}, this))\n\t\t\t\t\t.catch(() => alert('some error'));\n\t\t\t}\n\t\t\telse\n\t\t\t\talert(\"You don't have a permission!\")\n\t\t},\n\t\tdoModeratorUser: function () {\n\t\t\tif (current_user.is_admin == true) {\n\t\t\t\tfetch((\"/profile/do_moderator_user/\" + this.model.id))\n\t\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t\t.then(_.bind((res) => {\n\t\t\t\t\t\tif (res == 1)\n\t\t\t\t\t\t\talert(this.model.nickname + ' is now a moderator! :)')\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\talert(res)\n\t\t\t\t\t\tthis.model.is_moderator = true;\n\t\t\t\t\t\tthis.render()\n\t\t\t\t\t\tthis.btns.render()\n\t\t\t\t\t}, this))\n\t\t\t\t\t.catch(() => alert('Some error accured!'));\n\t\t\t}\n\t\t\telse\n\t\t\t\talert(\"You don't have a permission!\")\n\t\t},\n\t\tundoModeratorUser: function () {\n\t\t\tif (current_user.is_admin == true) {\n\t\t\t\tfetch((\"/profile/undo_moderator_user/\" + this.model.id))\n\t\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t\t.then(_.bind((res) => {\n\t\t\t\t\t\tif (res == 1)\n\t\t\t\t\t\t\talert(this.model.nickname + ' is not a moderator anymore!')\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\talert(res)\n\t\t\t\t\t\tthis.model.is_moderator = false;\n\t\t\t\t\t\tthis.render()\n\t\t\t\t\t\tthis.btns.render()\n\t\t\t\t\t}, this))\n\t\t\t\t\t.catch(() => alert('Some error accured!'));\n\t\t\t}\n\t\t\telse\n\t\t\t\talert(\"You don't have a permission!\")\n\t\t}\n\t})\n\n\tApp.Views.UserInfoBtn = Backbone.View.extend({\n\t\tid: 'UserButtons',\n\n\t\ttemplate:\t\t\t\t_.template($(\"#UserInfoBtnTemplate\").html()),\n\t\ttemplateEditBtn:\t\t_.template($(\"#UserInfoEditBtnTemplate\").html()),\n\t\ttemplateBannedStatus:\t_.template($(\"#UserInfoBannedStatusTemplate\").html()),\n\n\t\tevents: {\n\t\t\t'click #UserInfoAddBtn':\t\t'addFriend',\n\t\t\t'click #UserInfoDelBtn':\t\t'deleteFriend',\n\t\t\t'click #UserInfoUnfollowBtn': \t'unfollowUser',\n\t\t\t'click #UserInfoFollowBackBtn': 'followBackUser',\n\t\t\t'click #UserInfoSendBtn':\t\t'sendMessage',\n\t\t\t'click #UserInfoInviteBtn':\t\t'inviteToGame'\n\t\t},\n\t\trender: function () {\n\t\t\tif (current_user.id == this.model.id)\n\t\t\t\tthis.$el.html(this.templateEditBtn)\n\t\t\telse\n\t\t\t\tthis.drawBtn()\n\t\t\t$('#UserInfoBtn').html(this.el)\n\t\t},\n\t\taddFriend: function () {\n\t\t\tfetch((\"/friends/send_request/\" + this.model.id))\n\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t.then(_.bind((res) => {\n\t\t\t\tif (res == 1)\n\t\t\t\t\talert('You sent request to ' + this.model.nickname + '!')\n\t\t\t\telse\n\t\t\t\t\talert(res)\n\t\t\t\tthis.render()\n\t\t\t}, this))\n\t\t},\n\t\tfollowBackUser: function () {\n\t\t\tfetch((\"/friends/follow_back/\" + this.model.id))\n\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t.then(_.bind((res) => {\n\t\t\t\tif (res == 1)\n\t\t\t\t\talert('You and ' + this.model.nickname + ' became friends!')\n\t\t\t\tthis.render()\n\t\t\t}, this))\n\t\t\t.catch(() => alert('some error'));\n\t\t},\n\t\tdeleteFriend: function () {\n\t\t\tfetch((\"/friends/delete_from_friends/\" + this.model.id))\n\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t.then(_.bind((res) => {\n\t\t\t\tif (res == 1)\n\t\t\t\t\talert('You deleted ' + this.model.nickname + ' from friends :(')\n\t\t\t\telse\n\t\t\t\t\talert(res)\n\t\t\t\tthis.render()\n\t\t\t}, this))\n\t\t\t.catch(() => alert('some error'));\n\t\t},\n\t\tunfollowUser: function () {\n\t\t\tfetch((\"/friends/unfollow_user/\" + this.model.id))\n\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t.then(_.bind((res) => {\n\t\t\t\tif (res == 1)\n\t\t\t\t\talert('You unfollowed ' + this.model.nickname + ' :(')\n\t\t\t\telse\n\t\t\t\t\talert(res)\n\t\t\t\tthis.render()\n\t\t\t}, this))\n\t\t\t.catch(() => alert('some error'));\n\t\t},\n\t\tsendMessage: function () {\n\t\t\tfetch(\"/rooms/create\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\n\t\t\t\t\t'Accept': 'application/json',\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({ name: this.model.nickname, password: \"\" })\n\t\t\t})\n\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t.then(_.bind(function (res) {\n\t\t\t\t\twindow.location.href = \"/rooms/\" + res.id\n\t\t\t\t}, this))\n\t\t\t\t.catch(() => alert('some error'));\n\t\t},\n\t\tinviteToGame: function () {\n\t\t\tlet match = { player2: usr_id }\n\t\t\tfetch(\"/new_match_profile/\" + usr_id + \".json\")\n\t\t\t.then(res => res.json())\n\t\t\t.then(_.bind((res) => {\n\t\t\t\tif (res.error)\n\t\t\t\t\talert(res.error)\n\t\t\t\telse\n\t\t\t\t\tTurbolinks.visit(\"/matches/\" + res.id);\n\t\t\t}, this))\n\t\t},\n\t\tdrawBtn: function () {\n\t\t\tfetch((\"/friends/is_friend/\" + this.model.id))\n\t\t\t\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t\t\t\t.then(_.bind(function (res) {\n\t\t\t\t\tif (this.model.is_banned)\n\t\t\t\t\t\tthis.$el.html(this.templateBannedStatus);\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.$el.html(\"\");\n\t\t\t\t\tthis.$el.append(this.template({ btn_title: \"Send\", btn_text: \"SEND MESSAGE\" }));\n\t\t\t\t\tthis.$el.append(this.template({ btn_title: \"Invite\", btn_text: \"INVITE TO GAME\" }));\n\t\t\t\t\tif (res == 0 && !this.model.is_banned)\n\t\t\t\t\t\tthis.$el.append(this.template({ btn_title: \"Add\", btn_text: \"ADD TO FRIENDS\" }))\n\t\t\t\t\telse if (res == 1)\n\t\t\t\t\t\tthis.$el.append(this.template({ btn_title: \"Del\", btn_text: \"REMOVE FROM FRIENDS\" }))\n\t\t\t\t\telse if (res == 2)\n\t\t\t\t\t\tthis.$el.append(this.template({ btn_title: \"Unfollow\", btn_text: \"UNFOLLOW\" }))\n\t\t\t\t\telse if (!this.model.is_banned)\n\t\t\t\t\t\tthis.$el.append(this.template({ btn_title: \"FollowBack\", btn_text: \"FOLLOW BACK\" }))\n\t\t\t\t}, this))\n\t\t}\n\t})\n\n\n\n// ---------------------------------------------------------------------------------------------------------------------------\n//                                                   M A T C H E S\n// ---------------------------------------------------------------------------------------------------------------------------\n\n\tApp.Models.UserMatches = Backbone.Model.extend({\n\t\turlRoot: '/matches/users_matches/',\n\t\tinitialize: function () {\n\t\t\tthis.url += usr_id\n\t\t}\n\t})\n\n\tApp.Collections.UserMatches = Backbone.Collection.extend({\n\t\turl: '/matches/users_matches/',\n\t\tinitialize: function () {\n\t\t\tthis.url += usr_id\n\t\t\tthis.fetch()\n\t\t}\n\t})\n\n\t// -----------------------------------------\n\t//  USER      \t\tMATCHES CARD VIEW\n\t// -----------------------------------------\n\tApp.Views.UserMatches = Backbone.View.extend({\n\t\ttemplate: _.template($(\"#UserMatchesTemplate\").html()),\n\t\tinitialize: function (data) {\n\t\t\tthis.user = data.user\n\t\t\tthis.collection = data.collection\n\n\t\t\tthis.collection.on('sync', this.render, this)\n\t\t},\n\t\trender: function () {\n\t\t\tvar template = this.template();\n\t\t\t$(\"#UserMatches\").html(template)\n\n\t\t\tthis.n = 0\n\t\t\tif (this.collection.length <= 4) {\n\t\t\t\t$(\"#accordionFlushMatches\").css({ 'display': 'none' })\n\t\t\t\t$(\"#MatchesCard\").css({ 'border-bottom': '0px' })\n\t\t\t\tif (this.collection.length == 0)\n\t\t\t\t\t$(\"#MacthesList\").html(\"No matches yet\")\n\t\t\t}\n\t\t\tthis.collection.each(this.addOne, this)\n\t\t\treturn this\n\t\t},\n\t\taddOne: function (match) {\n\t\t\tif (this.n <= 4) {\n\t\t\t\tvar row = new App.Views.UserMatch({ model: match });\n\t\t\t\t$(\"#MacthesList\").append(row.render().el)\n\t\t\t\tthis.n += 1\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar row = new App.Views.UserMatch({ model: match });\n\t\t\t\t$(\"#MacthesListAll\").append(row.render().el)\n\t\t\t\tthis.n += 1\n\t\t\t}\n\t\t}\n\t})\n\n\tApp.Views.UserMatch = Backbone.View.extend({\n\t\ttemplate: _.template($(\"#MatchesRowTemplate\").html()),\n\t\tclassName: 'row',\n\t\trender: function () {\n\t\t\tthis.model.attributes.status = \"future\"\n\t\t\tif (this.model.attributes.is_end)\n\t\t\t\tthis.model.attributes.status = \"end\"\n\t\t\telse if (this.model.attributes.is_inprogress)\n\t\t\t\tthis.model.attributes.status = \"now\"\n\t\t\tthis.$el.html(this.template(this.model.attributes))\n\t\t\treturn this;\n\t\t},\n\t});\n\n//------------------------------------------------------------------------\n//\tCHANGE ONLINE STATUS\n//------------------------------------------------------------------------\n\tvar OnlineUsersModel = Backbone.Model.extend({ urlRoot: \"/users/online\" });\n\tvar OnlineUsersCollection = Backbone.Collection.extend({\n\t\turl: \"/users/online\",\n\t\tmodel: OnlineUsersModel,\n\t\tinitialize: function(current_user_id, profile_id) {\n\t\t\t_.bindAll(this, 'online');\n\t\t\tthis.profile_id = profile_id;\n\t\t\tthis.current_user_id = current_user_id;\n\t\t\tthis.fetch({\n\t\t\t\tsuccess: () => { this.online(); }\n\t\t\t})\n\t\t},\n\t\tonline: function() {\n\t\t\tthis.each((friend) => {\n\t\t\t\t$(`#ProfileOnlineStatus${this.current_user_id}`).css(\"color\", \"#0ec82d\");\n\t\t\t\t$(`#ProfileOnlineStatus${this.current_user_id}`).html(\"online\");\n\t\t\t\t\n\t\t\t\t$(`#FriendOnlineStatus${friend.get(\"id\")}`).css(\"background\", \"#0ec82d\")\n\t\t\t\t\n\t\t\t\tif (friend.get(\"id\") == this.profile_id) {\n\t\t\t\t\t$(`#ProfileOnlineStatus${this.profile_id}`).css(\"color\", \"#0ec82d\");\n\t\t\t\t\t$(`#ProfileOnlineStatus${this.profile_id}`).html(\"online\");\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t});\n\n// ---------------------------------------------------------------------------------------------------------------------------\n//                                                    M A I N\n// ---------------------------------------------------------------------------------------------------------------------------\n\n\tconst urlArray = window.jQuery.ajaxSettings.url.split('/')\n\tconst user_id = urlArray[urlArray.length - 1]\n\tfetch(\"/profile/get_curr_user\")\n\t.then(res => res.ok ? res.json() : Promise.reject(res))\n\t.then(function (res) {\n\t\twindow.current_user = new App.Models.User({ user: res })\n\t\tif (user_id == current_user.id || user_id == 0) {\n\t\t\tuser = current_user\n\t\t\trenderPage(user)\n\t\t}\n\t\telse {\n\t\t\tfetch((\"/profile/get_user/\" + user_id))\n\t\t\t.then(result => result.ok ? result.json() : Promise.reject(result))\n\t\t\t.then(function (result) {\n\t\t\t\tuser = new App.Models.User({ user: result })\n\t\t\t\trenderPage(user)\n\t\t\t})\n\t\t}\n\t})\n\tfunction renderPage(user) {\n\t\tif (!current_user.is_banned) {\n\t\t\twindow.usr_id = user.id\n\n\t\t\tuserInfoView = new App.Views.UserInfo({ model: user })\n\t\t\tuserInfoView.render()\n\n\t\t\tUserFriends = new App.Collections.UserFriends()\n\t\t\tUserFriendsView = new App.Views.UserFriends({ collection: UserFriends })\n\t\t\tUserFriendsView.render()\n\n\t\t\tif (user.id == current_user.id) {\n\t\t\t\tUserFriendRequests = new App.Collections.UserFollowers()\n\t\t\t\tUserFriendRequestsView = new App.Views.UserFriendRequests({ collection: UserFriendRequests })\n\t\t\t}\n\n\t\t\tInvitesCollection = new App.Collections.GuildInvites()\n\t\t\tUserGuildView = new App.Views.UserGuild({ model: user, invitesCollection: InvitesCollection })\n\t\t\tUserGuildView.render()\n\n\t\t\tUserMatches = new App.Collections.UserMatches\n\t\t\tUserMatchesView = new App.Views.UserMatches({ user: user, collection: UserMatches })\n\t\t\tUserMatchesView.render()\n\n\t\t\tif (user.id == current_user.id) {\n\t\t\t\tUserBlocklist = new App.Collections.Blocklist()\n\t\t\t\tUserBlocklistView = new App.Views.UserBlocklist({ collection: UserBlocklist })\n\t\t\t}\n\t\t\tsetTimeout( () => { new OnlineUsersCollection(current_user.id, user_id)}, 1500);\n\t\t}\n\t\telse\n\t\t\t$(\".content\").html(\"<h3>You account was blocked by administrator</h3>\")\n\t}\n}());\n"]},"metadata":{},"sourceType":"module"}